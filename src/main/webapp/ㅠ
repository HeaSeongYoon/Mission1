<%@ page import="java.util.List" %>
<%@ page import="org.example.service.PubService" %>
<%@ page import="org.example.domain.PubWifi" %>
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wi-Fi Details</title>
    <style>
        body {
                  font-family: Arial, sans-serif;
                }

                .container {
                  text-align: left;
                  max-width: 100%;
                  margin: 0 auto;
                }

                .input-group {
                  display: inline-block;
                }

                table {
                  width: 100%;
                  border-collapse: collapse;
                }

                th,
                td {
                  border: 1px solid #ddd;
                  padding: 8px;
                  text-align: left;
                }

                th {
                  background-color: #00ad6f;
                  color: #ffffff;
                  border: 1px solid #ccc;
                }

                a {
                  text-decoration: none;
                  color: #1a0dab;
                }

                a:hover {
                  text-decoration: underline;
                }

                .navigation {
                    margin-bottom: 20px;
                }

                .instruction {
                      margin-top: 0.5em;
                      font-size: 14px;
                      text-align: center;
                      padding: 10px;
                      display: table;
                      margin: 0 auto;
                      margin-bottom: 20px;
                    }

                    .instruction-container {
                      border: 1px solid #ccc;
                      padding: 0.5em;
                      width: 100%;
                    }

                    .bookmark-group {
                      margin: 10px 0;
                    }
    </style>
    <script>
            function getGeolocation() {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(showDistance, gotError);
                } else {
                    alert("지원되지 않는 브라우저입니다.");
                }
            }

            function gotError(error) {
                console.log("Error: code " + error.code + ", message : " + error.message);
                document.getElementById("distance").innerHTML = "지원되지 않는 기능입니다.";
            }

            function showDistance(position) {
                const lat = position.coords.latitude;
                const lon = position.coords.longitude;
                document.getElementById("myLat").value = lat;
                document.getElementById("myLon").value = lon;
                displayDistance();
            }

            function deg2rad(deg) {
                return deg * (Math.PI / 180);
            }

            function calcDistance(lat1, lon1, lat2, lon2) {
                const R = 6371;
                const dLat = deg2rad(lat2 - lat1);
                const dLon = deg2rad(lon2 - lon1);
                const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +
                          Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) *
                          Math.sin(dLon / 2) * Math.sin(dLon / 2);
                const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
                const d = R * c;

                return d.toFixed(2);
            }

            function displayDistance() {
                const lat1 = parseFloat(document.getElementById("myLat").value);
                const lon1 = parseFloat(document.getElementById("myLon").value);
                const lat2 = parseFloat(document.getElementById("wifiLat").value);
                const lon2 = parseFloat(document.getElementById("wifiLon").value);
                const distance = calcDistance(lat1, lon1, lat2, lon2);
                document.getElementById("distance").innerHTML = distance;
            }
        </script>
</head>
<body>
    <div class="container">
            <h1>와이파이 정보 구하기</h1>
            <div class="navigation">
                <a href="index.jsp">홈</a> |
                <a href="history.jsp">위치 히스토리 목록</a> |
                <a href="load-wifi.jsp">Open API 와이파이 정보 가져오기</a> |
                <a href="">북마크 보기</a> |
                <a href="bookmark_groups.jsp">북마크 그룹 관리</a>
            </div>
            <div class="bookmark-group">
                <select name="bookmark-group-selector" id="bookmark-group-selector">
                    <option value="" disabled selected>북마크 그룹 이름 선택하기</option>
                    <!-- 북마크 그룹 리스트 추가 -->
                    <!-- 예시: <option value="sample-group">예시 그룹</option> -->
                </select>
                <button type="button">북마크 추가하기</button>
            </div>
        </div>
    <%
        String id = request.getParameter("id");
                PubService service = new PubService();
                List<PubWifi> wifiList = service.list("126.844928", "37.535744"); // 예시 좌표값
                PubWifi wifi = null;

                for (PubWifi p : wifiList) {
                    if (p.getMgrNo().equals(id)) {
                        wifi = p;
                        break;
                    }
                }
    %>
    <% if(wifi != null) { %>
    <table border="1">
        <tr>
                    <th>거리(km)</th>
                    <td id="distance">
                        <input type="hidden" id="myLat" value="">
                        <input type="hidden" id="myLon" value="">
                        <input type="hidden" id="wifiLat" value="<%= wifi.getLatitude() %>">
                        <input type="hidden" id="wifiLon" value="<%= wifi.getLongitude() %>">
                    </td>
                </tr>
        <tr>
                    <th>관리번호</th>
                    <td><%= wifi.getMgrNo() %></td>
                </tr>
                <tr>
                    <th>와이파이 명칭</th>
                    <td><%= wifi.getMainNm() %></td>
                </tr>
                <tr>
                    <th>도로명주소</th>
                    <td><%= wifi.getAddress() %></td>
                </tr>
                <tr>
                    <th>상세주소</th>
                    <td><%= wifi.getAddressDetail() %></td>
                </tr>
                <tr>
                    <th>설치위치(층)</th>
                    <td><%= wifi.getInstallFloor() %></td>
                </tr>
                <tr>
                    <th>설치유형</th>
                    <td><%= wifi.getInstallTy() %></td>
                </tr>
                <tr>
                    <th>설치기관</th>
                    <td><%= wifi.getInstallMby() %></td>
                </tr>
                <tr>
                    <th>서비스구분</th>
                    <td><%= wifi.getServiceSe() %></td>
                </tr>
                <tr>
                    <th>망종류</th>
                    <td><%= wifi.getNetworkTy() %></td>
                </tr>
                <tr>
                    <th>설치년도</th>
                    <td><%= wifi.getInstallYear() %></td>
                </tr>
                <tr>
                    <th>실내외구분</th>
                    <td><%= wifi.getIsOutdoor() %></td>
                </tr>
                <tr>
                    <th>X좌표</th>
                    <td><%= wifi.getLongitude() %></td>
                </tr>
                <tr>
                    <th>Y좌표</th>
                    <td><%= wifi.getLatitude() %></td>
                </tr>
                <tr>
                    <th>작업일자</th>
                    <td><%= wifi.getWorkDate() %></td>
                </tr>
    </table>
    <script>getGeolocation();</script>
    <% } else { %>
        <p>해당 ID의 Wi-Fi 정보를 찾지 못했습니다.</p>
    <% } %>
</body>
</html>






-------------------------


기존



<%@ page import="java.util.List" %>
<%@ page import="org.example.service.PubService" %>
<%@ page import="org.example.domain.PubWifi" %>
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wi-Fi Details</title>
    <style>
        body {
          font-family: Arial, sans-serif;
        }

        .container {
          text-align: left;
          max-width: 100%;
          margin: 0 auto;
        }

        .input-group {
          display: inline-block;
        }

        table {
          width: 100%;
          border-collapse: collapse;
        }

        th,
        td {
          border: 1px solid #ddd;
          padding: 8px;
          text-align: left;
        }

        th {
          background-color: #00ad6f;
          color: #ffffff;
          border: 1px solid #ccc;
        }

        a {
          text-decoration: none;
          color: #1a0dab;
        }

        a:hover {
          text-decoration: underline;
        }

        .navigation {
            margin-bottom: 20px;
        }

        .instruction {
              margin-top: 0.5em;
              font-size: 14px;
              text-align: center;
              padding: 10px;
              display: table;
              margin: 0 auto;
              margin-bottom: 20px;
            }

            .instruction-container {
              border: 1px solid #ccc;
              padding: 0.5em;
              width: 100%;
            }

            .bookmark-group {
              margin: 10px 0;
            }

    </style>
</head>
<body>
    <div class="container">
        <h1>와이파이 정보 구하기</h1>
        <div class="navigation">
            <a href="index.jsp">홈</a> |
            <a href="history.jsp">위치 히스토리 목록</a> |
            <a href="load-wifi.jsp">Open API 와이파이 정보 가져오기</a> |
            <a href="">북마크 보기</a> |
            <a href="bookmark_groups.jsp">북마크 그룹 관리</a>
        </div>
        <div class="bookmark-group">
            <select name="bookmark-group-selector" id="bookmark-group-selector">
                <option value="" disabled selected>북마크 그룹 이름 선택하기</option>
                <!-- 북마크 그룹 리스트 추가 -->
                <!-- 예시: <option value="sample-group">예시 그룹</option> -->
            </select>
            <button type="button">북마크 추가하기</button>
        </div>
    </div>
    <%
        String id = request.getParameter("id");
        PubService service = new PubService();
        List<PubWifi> wifiList = service.list("126.844928", "37.535744"); // 예시 좌표값
        PubWifi wifi = null;

        for (PubWifi p : wifiList) {
            if (p.getMgrNo().equals(id)) {
                wifi = p;
                break;
            }
        }
    %>
    <% if(wifi != null) { %>
    <table border="1">
        <tr>
            <th>거리(km)</th>
            <td><%= wifi.getDist() %></td>
        </tr>
        <tr>
            <th>관리번호</th>
            <td><%= wifi.getMgrNo() %></td>
        </tr>
        <tr>
            <th>와이파이 명칭</th>
            <td><%= wifi.getMainNm() %></td>
        </tr>
        <tr>
            <th>도로명주소</th>
            <td><%= wifi.getAddress() %></td>
        </tr>
        <tr>
            <th>상세주소</th>
            <td><%= wifi.getAddressDetail() %></td>
        </tr>
        <tr>
            <th>설치위치(층)</th>
            <td><%= wifi.getInstallFloor() %></td>
        </tr>
        <tr>
            <th>설치유형</th>
            <td><%= wifi.getInstallTy() %></td>
        </tr>
        <tr>
            <th>설치기관</th>
            <td><%= wifi.getInstallMby() %></td>
        </tr>
        <tr>
            <th>서비스구분</th>
            <td><%= wifi.getServiceSe() %></td>
        </tr>
        <tr>
            <th>망종류</th>
            <td><%= wifi.getNetworkTy() %></td>
        </tr>
        <tr>
            <th>설치년도</th>
            <td><%= wifi.getInstallYear() %></td>
        </tr>
        <tr>
            <th>실내외구분</th>
            <td><%= wifi.getIsOutdoor() %></td>
        </tr>
        <tr>
            <th>X좌표</th>
            <td><%= wifi.getLongitude() %></td>
        </tr>
        <tr>
            <th>Y좌표</th>
            <td><%= wifi.getLatitude() %></td>
        </tr>
        <tr>
            <th>작업일자</th>
            <td><%= wifi.getWorkDate() %></td>
        </tr>
    </table>
    <% } else { %>
        <p>해당 ID의 Wi-Fi 정보를 찾지 못했습니다.</p>
    <% } %>
</body>
</html>
